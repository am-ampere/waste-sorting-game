<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏¢‡∏Å‡∏Å‡∏π‡πâ(KU)‡πÇ‡∏•‡∏Å</title>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@500;600;700&display=swap" rel="stylesheet">
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <style>
    :root { --primary-green: #067957; --bg-light: #ebf7ef; }
    body { margin: 0; font-family: 'Prompt', sans-serif; background-color: var(--bg-light); color: var(--primary-green); height: 100vh; overflow: hidden; }
    .container { height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: space-between; padding: 40px 25px; box-sizing: border-box; text-align: center; }
    .hidden { display: none !important; }
    
    /* ‡πÅ‡∏Å‡πâ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏π‡∏õ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á: ‡πÉ‡∏ä‡πâ‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô */
    .img-wrap { width: 100%; display: flex; justify-content: center; }
    .main-logo { width: 140px; height: auto; min-height: 50px; }
    .center-img { width: 100px; height: auto; margin: 15px 0; }
    .partner-logos { width: 150px; height: auto; }

    h1 { font-size: 1.8rem; font-weight: 700; margin: 5px 0; line-height: 1.2; }
    .btn-start { background: var(--primary-green); color: #fff; border: none; padding: 12px 60px; border-radius: 50px; font-size: 1.3rem; font-weight: 600; cursor: pointer; }
    
    /* ‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏à‡∏∞‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô */
    .choices-stack { width: 100%; max-width: 320px; display: flex; flex-direction: column; align-items: center; }
    .choice-btn { width: 100%; background: #fff; border: 2px solid var(--primary-green); padding: 14px; margin: 8px 0; border-radius: 50px; font-size: 1.1rem; color: var(--primary-green); font-weight: 600; display: block; text-align: center; }
    
    .score-big { font-size: 5rem; font-weight: 700; line-height: 1; margin: 0; }
    .loader { border: 5px solid #f3f3f3; border-top: 5px solid var(--primary-green); border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
  </style>
</head>
<body>

<div id="loading-page" class="container" style="justify-content: center;"><div class="loader"></div></div>

<div id="start-page" class="container hidden">
  <div class="img-wrap"><img src="https://i.ibb.co/h1J2dHjq/image.png" class="main-logo"></div>
  <div>
    <h1>‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ<br><span id="user-name">‡∏Ñ‡∏∏‡∏ì‡∏û‡∏µ‡πà</span></h1>
    <p>‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏¢‡∏Å‡∏Ç‡∏¢‡∏∞‡πÄ‡∏Å‡πà‡∏á‡πÅ‡∏Ñ‡πà‡πÑ‡∏´‡∏ô ‡∏°‡∏≤‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏±‡∏ô!</p>
    <button class="btn-start" onclick="startGame()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°</button>
  </div>
  <div class="img-wrap"><img src="https://i.ibb.co/zWfz6wJJ/image.png" class="center-img"></div>
  <div class="footer">
    <p style="font-size: 0.75rem; margin-bottom: 5px;">‡∏ó‡∏¥‡πâ‡∏á‡∏ñ‡∏π‡∏Å‡∏ó‡∏µ‡πà ‡∏•‡∏î‡∏ñ‡∏∏‡∏á‡∏Ç‡∏¢‡∏∞‡∏¢‡πà‡∏≠‡∏¢‡∏™‡∏•‡∏≤‡∏¢‡πÑ‡∏î‡πâ</p>
    <div class="img-wrap"><img src="https://i.ibb.co/CsQTb51N/image.png" class="partner-logos"></div>
  </div>
</div>

<div id="game-page" class="container hidden">
  <div class="img-wrap"><img src="https://i.ibb.co/h1J2dHjq/image.png" class="main-logo"></div>
  <div style="flex-grow: 1; display: flex; flex-direction: column; justify-content: center; width: 100%;">
    <h1 id="question-text"></h1>
    <div id="choices-container" class="choices-stack"></div>
  </div>
  <div class="footer"><div class="img-wrap"><img src="https://i.ibb.co/CsQTb51N/image.png" class="partner-logos"></div></div>
</div>

<div id="result-page" class="container hidden">
  <div class="img-wrap"><img src="https://i.ibb.co/h1J2dHjq/image.png" class="main-logo"></div>
  <div>
    <p id="final-score" class="score-big">0/4</p>
    <p id="result-user-name" style="font-weight: 600;"></p>
    <h1 id="result-title">‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å!</h1>
    <p id="result-desc">‡∏Ñ‡∏∏‡∏ì‡∏ä‡πà‡∏ß‡∏¢‡πÇ‡∏•‡∏Å‡πÑ‡∏õ‡πÑ‡∏î‡πâ‡πÄ‡∏¢‡∏≠‡∏∞‡πÄ‡∏•‡∏¢</p>
  </div>
  <div class="footer">
    <p style="font-weight: 700;">üçÉ ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏ß‡∏¢‡∏Å‡∏±‡∏ô üåç</p>
    <div class="img-wrap"><img src="https://i.ibb.co/CsQTb51N/image.png" class="partner-logos"></div>
  </div>
</div>

<script>
  const LIFF_ID = "2008938028-gCqozVV5";
  const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzjA_-iFEqrdTJzHlngMAIg1HQ7b0Bhot8eOHvRvShzmxHgCgGkngfD7CQOmSr50viz/exec";

  const questions = [
    { q: "‡∏Ç‡∏ß‡∏î‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å<br>‡∏Ñ‡∏ß‡∏£‡∏ó‡∏¥‡πâ‡∏á‡∏ñ‡∏±‡∏á‡πÑ‡∏´‡∏ô?", options: ["‡∏ñ‡∏±‡∏á‡∏Ç‡∏¢‡∏∞‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏•", "‡∏ñ‡∏±‡∏á‡∏Ç‡∏¢‡∏∞‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ", "‡∏ñ‡∏±‡∏á‡∏ã‡∏±‡∏°‡∏à‡∏±‡πã‡∏á"], answer: 0 },
    { q: "‡∏ô‡πâ‡∏≥‡∏´‡∏°‡∏î ‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠<br>‡∏ó‡∏¥‡πâ‡∏á‡∏¢‡∏±‡∏á‡πÑ‡∏á‡∏î‡∏µ?", options: ["‡∏ó‡∏¥‡πâ‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô‡πÑ‡∏õ‡πÄ‡∏•‡∏¢", "‡πÅ‡∏¢‡∏Å‡∏ô‡πâ‡∏≥/‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á", "‡∏Å‡∏¥‡∏ô‡πÅ‡∏Å‡πâ‡∏ß‡∏•‡∏á‡πÑ‡∏õ"], answer: 1 },
    { q: "‡πÑ‡∏°‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏ö‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô<br>‡∏ó‡∏¥‡πâ‡∏á‡∏¢‡∏±‡∏á‡πÑ‡∏á‡∏î‡∏µ?", options: ["‡πÄ‡∏™‡∏µ‡∏¢‡∏ö‡∏Ñ‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡πÜ", "‡πÄ‡∏™‡∏µ‡∏¢‡∏ö‡∏Ç‡πâ‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏á", "‡∏ó‡∏¥‡πâ‡∏á‡∏•‡∏á‡∏ñ‡∏±‡∏á‡πÑ‡∏°‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏ö"], answer: 2 },
    { q: "‡∏Ç‡∏¢‡∏∞‡πÄ‡∏®‡∏©‡∏≠‡∏≤‡∏´‡∏≤‡∏£<br>‡∏ó‡∏¥‡πâ‡∏á‡∏¢‡∏±‡∏á‡πÑ‡∏á‡∏î‡∏µ?", options: ["‡πÄ‡∏ó‡πÉ‡∏™‡πà‡∏ñ‡πâ‡∏ß‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô", "‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡∏î‡∏π‡∏ï‡πà‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤", "‡∏ó‡∏¥‡πâ‡∏á‡∏•‡∏á‡∏ñ‡∏±‡∏á‡πÄ‡∏®‡∏©‡∏≠‡∏≤‡∏´‡∏≤‡∏£"], answer: 2 }
  ];

  let currentStep = 0, score = 0, playerName = "‡∏Ñ‡∏∏‡∏ì‡∏û‡∏µ‡πà", lineId = "unknown", userAnswers = [];

  async function initLIFF() {
    try {
      await liff.init({ liffId: LIFF_ID });
      if (liff.isLoggedIn()) {
        const profile = await liff.getProfile();
        playerName = profile.displayName;
        lineId = profile.userId;
      }
    } catch(e) { console.log("LIFF fail"); }
    finally {
      document.getElementById('user-name').innerText = playerName;
      document.getElementById('loading-page').classList.add('hidden');
      document.getElementById('start-page').classList.remove('hidden');
    }
  }

  function startGame() {
    document.getElementById('start-page').classList.add('hidden');
    document.getElementById('game-page').classList.remove('hidden');
    showQuestion();
  }

  function showQuestion() {
    const data = questions[currentStep];
    document.getElementById('question-text').innerHTML = data.q;
    const container = document.getElementById('choices-container');
    container.innerHTML = ""; // ‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏Å‡πà‡∏≤
    
    data.options.forEach((opt, i) => {
      const btn = document.createElement('button');
      btn.className = 'choice-btn';
      btn.innerText = opt; // ‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á
      btn.onclick = () => {
        userAnswers.push(opt);
        if(i === data.answer) score++;
        currentStep++;
        if(currentStep < questions.length) showQuestion();
        else finishGame();
      };
      container.appendChild(btn);
    });
  }

  function finishGame() {
    document.getElementById('game-page').classList.add('hidden');
    document.getElementById('result-page').classList.remove('hidden');
    document.getElementById('final-score').innerText = score + "/4";
    document.getElementById('result-user-name').innerText = "‡∏Ñ‡∏∏‡∏ì " + playerName;
    
    // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö JSON ‡πÑ‡∏õ‡∏¢‡∏±‡∏á Apps Script
    fetch(SCRIPT_URL, {
      method: 'POST',
      mode: 'no-cors',
      cache: 'no-cache',
      body: JSON.stringify({
        name: playerName,
        score: score,
        answers: userAnswers
      })
    }).then(() => console.log("Success")).catch(e => console.log("Error"));
  }

  window.onload = initLIFF;
</script>
</body>
</html>
