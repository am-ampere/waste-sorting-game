<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡πÅ‡∏¢‡∏Å‡∏Ç‡∏¢‡∏∞‡∏£‡∏±‡∏Å‡∏©‡πå‡πÇ‡∏•‡∏Å</title>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <style>
    body { margin: 0; font-family: sans-serif; background: #e9f7ef; color: #1e5c3a; }
    .container { min-height: 100vh; padding: 20px; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; }
    .hidden { display: none !important; }
    .title-emoji { font-size: 2.8rem; }
    .title-text { font-size: 2.1rem; margin-bottom: 24px; }
    .btn { width: 100%; max-width: 340px; padding: 14px; margin: 8px 0; border-radius: 14px; border: none; background: #ffffff; cursor: pointer; font-size: 1.2rem; box-shadow: 0 3px 6px rgba(0,0,0,0.1); }
    .btn.correct { background: #4caf50; color: #fff; }
    .btn.wrong { background: #f44336; color: #fff; }
    .question { font-size: 1.5rem; margin-bottom: 20px; }
    .message { margin-top: 16px; min-height: 32px; }
    .logo { max-width: 160px; margin: 12px 0; }
    /* ‡∏´‡∏ô‡πâ‡∏≤ Loading ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏£‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏ä‡∏∑‡πà‡∏≠ LINE */
    #loading { font-size: 1.2rem; color: #1e5c3a; }
  </style>
</head>
<body>

<div id="loading" class="container">
  <div class="title-emoji">‚åõ</div>
  <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÇ‡∏•‡∏Å‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß...</p>
</div>

<div id="start" class="container hidden">
  <div class="title-emoji">üóëÔ∏è‚ôªÔ∏è</div>
  <div class="title-text">‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏∏‡∏ì <span id="display-name"></span><br>‡∏Ç‡∏¢‡∏∞‡∏ô‡∏µ‡πâ‡∏Ñ‡∏ß‡∏£‡∏ó‡∏¥‡πâ‡∏á‡∏ñ‡∏±‡∏á‡πÑ‡∏´‡∏ô?</div>
  <button class="btn" onclick="startGame()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô üåç</button>
</div>

<div id="game" class="container hidden">
  <div id="question" class="question"></div>
  <div id="choices"></div>
  <div id="message" class="message"></div>
</div>

<div id="end" class="container hidden">
  <h1>üéâ ‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å!</h1>
  <p id="finalScoreDisplay"></p>
  <p>‡∏ó‡∏∏‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏¢‡∏Å‡∏Ç‡∏¢‡∏∞ = 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏ß‡∏¢‡πÇ‡∏•‡∏Å üåçüíö</p>
  <img class="logo" src="https://www.advancebio11.com/wp-content/uploads/2025/07/New-Advance-BIO_s-logo-430x121_result.webp" alt="Logo">
  <br>
  <a href="https://lin.ee/9I8XlM7" target="_blank">
    <img style="max-width:200px;" src="https://drive.google.com/uc?export=view&id=1fBN0BzUOyKKCiJk06VacK2dsyrPx5sb7" alt="Add Line">
  </a>
</div>

<script>
  // 1. ‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç
  const MY_LIFF_ID = "2008938028-gCqozVV5"; // ‡πÉ‡∏™‡πà LIFF ID ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
  const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbzeoyz1cTR4lW4NE-HkUYLia2J2Xw9TFfIUp7j-8tmEQTrKIjSP1P9FaFVXecuZr7Ux/exec"; 

  const questions = [
    { text: "üß¥ ‡∏Ç‡∏ß‡∏î‡∏ô‡πâ‡∏≥‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å‡∏Ñ‡∏ß‡∏£‡∏ó‡∏¥‡πâ‡∏á‡∏ñ‡∏±‡∏á‡πÑ‡∏´‡∏ô?", choices: ["‚ôªÔ∏è ‡∏ñ‡∏±‡∏á‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏•", "üîµ ‡∏ñ‡∏±‡∏á‡∏Ç‡∏¢‡∏∞‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ", "üçÉ ‡∏ñ‡∏±‡∏á‡∏Ç‡∏¢‡∏∞‡πÄ‡∏õ‡∏µ‡∏¢‡∏Å"], answer: 0 },
    { text: "üçå ‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏£‡∏ó‡∏¥‡πâ‡∏á‡∏ñ‡∏±‡∏á‡πÑ‡∏´‡∏ô?", choices: ["‚ôªÔ∏è ‡∏ñ‡∏±‡∏á‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏•", "üçÉ ‡∏ñ‡∏±‡∏á‡∏Ç‡∏¢‡∏∞‡πÄ‡∏õ‡∏µ‡∏¢‡∏Å", "üîµ ‡∏ñ‡∏±‡∏á‡∏Ç‡∏¢‡∏∞‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ"], answer: 1 },
    { text: "ü•§ ‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏ß‡∏£‡∏ó‡∏≥‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?", choices: ["üöÆ ‡∏ó‡∏¥‡πâ‡∏á‡∏ó‡∏±‡πâ‡∏á‡πÅ‡∏Å‡πâ‡∏ß", "üßä ‡πÄ‡∏ó‡∏ô‡πâ‡∏≥‡∏≠‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏•", "üçÉ ‡∏ó‡∏¥‡πâ‡∏á‡∏•‡∏á‡∏Ç‡∏¢‡∏∞‡πÄ‡∏õ‡∏µ‡∏¢‡∏Å"], answer: 1 }
  ];

  let playerName = "";
  let userResponses = [];
  let score = 0;
  let current = 0;

  // 2. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏£‡∏∞‡∏ö‡∏ö LINE LIFF
  async function initializeLiff() {
    try {
      await liff.init({ liffId: MY_LIFF_ID });
      if (!liff.isLoggedIn()) {
        liff.login();
      } else {
        const profile = await liff.getProfile();
        playerName = profile.displayName; // ‡∏î‡∏∂‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏≤‡∏Å LINE
        document.getElementById("display-name").innerText = playerName;
        
        // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏î‡∏∂‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏™‡∏£‡πá‡∏à ‡πÉ‡∏´‡πâ‡πÇ‡∏ä‡∏ß‡πå‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°
        document.getElementById("loading").classList.add("hidden");
        document.getElementById("start").classList.remove("hidden");
      }
    } catch (err) {
      console.error("LIFF Error", err);
    }
  }

  // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ LIFF ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
  window.onload = initializeLiff;

  function hideAll() {
    document.getElementById("loading").classList.add("hidden");
    document.getElementById("start").classList.add("hidden");
    document.getElementById("game").classList.add("hidden");
    document.getElementById("end").classList.add("hidden");
  }

  function startGame() {
    hideAll();
    current = 0;
    score = 0;
    userResponses = [];
    document.getElementById("game").classList.remove("hidden");
    showQuestion();
  }

  function showQuestion() {
    const q = questions[current];
    document.getElementById("question").innerText = q.text;
    const choicesDiv = document.getElementById("choices");
    choicesDiv.innerHTML = "";
    document.getElementById("message").innerText = "";

    q.choices.forEach((choice, index) => {
      const btn = document.createElement("button");
      btn.className = "btn";
      btn.innerText = choice;
      btn.onclick = () => checkAnswer(index, btn);
      choicesDiv.appendChild(btn);
    });
  }

  function checkAnswer(index, btn) {
    const isCorrect = (index === questions[current].answer);
    userResponses.push({
        userAnswer: questions[current].choices[index],
        isCorrect: isCorrect
    });

    if (isCorrect) {
      score++;
      btn.classList.add("correct");
      document.getElementById("message").innerText = "‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á! üå±";
      setTimeout(nextQuestion, 800);
    } else {
      btn.classList.add("wrong");
      document.getElementById("message").innerText = "‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏ô‡∏∞ ‡πÇ‡∏•‡∏Å‡πÉ‡∏´‡πâ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏à üåçüíö";
    }
  }

  function nextQuestion() {
    current++;
    if (current < questions.length) {
      showQuestion();
    } else {
      sendData();
      hideAll();
      document.getElementById("finalScoreDisplay").innerText = "‡∏Ñ‡∏∏‡∏ì " + playerName + " ‡∏ó‡∏≥‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÑ‡∏î‡πâ " + score + "/" + questions.length;
      document.getElementById("end").classList.remove("hidden");
    }
  }

  function sendData() {
    const data = { name: playerName, totalScore: score, details: userResponses };
    fetch(WEB_APP_URL, {
      method: "POST",
      mode: "no-cors",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data)
    });
  }
</script>
</body>
</html>
